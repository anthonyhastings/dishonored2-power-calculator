name: Release

on:
  workflow_dispatch:
  workflow_run:
    workflows: ["Test"]
    branches:
      - master
    types:
      - completed

env:
  GOOGLE_SITE_VERIFICATION_TOKEN: cj8IJgpHPbgqe4Xs9_dAAUzO07qGnnnz5SlSN32fOnA
  PORT: 8080

jobs:
  release:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    env:
      GH_TOKEN: ${{ secrets.GH_TOKEN }}
      HEROKU_API_KEY: ${{ secrets.HEROKU_API_KEY }}
      HEROKU_APP_NAME: dishonored2-power-calculator
    steps:
    - name : machine echo github
      env : { CONTENT : "${{ toJson(github) }}" }
      run : "echo $CONTENT"
    - name : machine echo runner
      env : { CONTENT : "${{ toJson(runner) }}" }
      run : "echo $CONTENT"
    - name : machine echo job
      env : { CONTENT : "${{ toJson(job) }}" }
      run : "echo $CONTENT"
    - name : machine echo strategy
      env : { CONTENT : "${{ toJson(strategy) }}" }
      run : "echo $CONTENT"
    - name : machine echo matrix
      env : { CONTENT : "${{ toJson(matrix) }}" }
      run : "echo $CONTENT"
    - name : machine echo steps
      env : { CONTENT : "${{ toJson(steps) }}" }